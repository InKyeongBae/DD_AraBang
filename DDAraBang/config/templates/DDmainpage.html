{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MainPage</title>

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>MAIN PAGE</title>
        <link rel="stylesheet" type="text/css"
              href="https://cdn.rawgit.com/moonspam/NanumSquare/master/nanumsquare.css">
        <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100;300;400;500;700;900&display=swap"
              rel="stylesheet">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/bxslider/4.2.12/jquery.bxslider.css">
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
              integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf"
              crossorigin="anonymous">

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
        <script src="https://cdn.jsdelivr.net/bxslider/4.2.12/jquery.bxslider.min.js"></script>

        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
              integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
              crossorigin="anonymous">
        <script>
            $(document).ready(function () {
                $('.slider').bxSlider({
                    mode: 'horizontal',// 가로 방향 수평 슬라이드
                    speed: 40,        // 이동 속도를 설정
                    pager: false,      // 현재 위치 페이징 표시 여부 설정
                    moveSlides: 1,     // 슬라이드 이동시 개수
                    slideWidth: 340,   // 슬라이드 너비
                    minSlides: 1,      // 최소 노출 개수
                    maxSlides: 1,      // 최대 노출 개수
                    slideMargin: 5,    // 슬라이드간의 간격
                    auto: true,        // 자동 실행 여부
                    autoHover: false,   // 마우스 호버시 정지 여부
                    controls: false,    // 이전 다음 버튼 노출 여부
                });
            });
        </script>

        <style>

            * {
                text-decoration: none;
                margin: 0;
                padding: 0;
            }

            body {
                width: 100%;
                height: 100%;
                display: flex;
                flex-direction: column;
            }

            .mainpage-login {
                height: 50px;
                width: 100%;
                padding: .5rem;
                background-color: #662DE0;
                display: flex;
                flex-direction: row-reverse;
            }

            .mainpage-btn {
                padding: 0.2rem 1.5rem;
                margin-right: 1rem;
                border-radius: 10rem;
                color: #ffffff;
                font-size: 1rem;
                border: 2px solid #662DE0;
                background-color: #662DE0;
                -webkit-transition: all 0.5s;
                -moz-transition: all 0.5s;
                transition: all 0.5s;
            }

            .mainpage-btn:hover {
                text-decoration: none;!important;
                border: 2px solid #61F056;
                color: #61F056;
                -webkit-transition: all 0.5s;
                -moz-transition: all 0.5s;
                transition: all 0.5s;
            }

            .mainpage-logo {
                background-color: #662DE0;
                border: none;
                color: #ffffff;
                text-align: center;
                padding: 2rem;
            }

            #dandi {
                font-family: 'MapoDPPA';
                font-size: 3rem;
            }

            #comment {
                font-size: 1rem;
            }

            .container {
                width: 85%;
                margin: 0 auto;
                padding: 0;
            }

            #main-service-1 {
                width: 100%;
                padding-top: 2rem;
                padding-bottom: 1rem;
                margin: 0;
            }

            #title-1 {
                padding: 2rem 0;
                text-align: center;
                display: flex;
                flex-direction: column;
                justify-content: center;
            }

            #sub-title-1 {
                font-size: 1.5rem;
                font-weight: bold;
                margin-bottom: 1rem;
            }

            #main-service-map {
                padding: 2rem .5rem;
                display: flex;
                flex-direction: column;
                justify-content: center;
            }

            #main-service-map img {
                width: 100%;
            }

            .mainpage-map-btn {
                text-decoration: none;!important;
                padding: 0.2rem 1.5rem;
                margin: 1rem auto;
                border-radius: 10rem;
                color: #662DE0;
                font-size: 1.2rem;
                border: 2px solid #7671F0;
                background-color: #ffffff;
                -webkit-transition: all 0.5s;
                -moz-transition: all 0.5s;
                transition: all 0.5s;
            }

            .mainpage-map-btn:hover {
                text-decoration: none;!important;
                background-color: #7671F0;
                color: #ffffff;
                font-weight: bold;
            }

            #main-service-2 {
                margin: 0;
                padding: 2rem;
                width: 100%;
                background-color: #7671F0;
                color: #ffffff;
                text-align: center;
                display: flex;
                flex-direction: column;
                justify-content: center;
            }

            #sub-title-2 {
                font-size: 1.5rem;
                font-weight: bold;
                margin-bottom: 1rem;
            }

            #main-service-2 p {
                margin-bottom: 1rem;
            }

            #main-service-3 {
                margin: 2rem 0;
            }

            .all-community-btn {
                text-decoration: none;!important;
                padding: 0.2rem 2rem;
                margin: 1rem auto;
                border-radius: 10rem;
                color: #ffffff;
                font-size: 1.2rem;
                border: 2px solid #ffffff;
                -webkit-transition: all 0.5s;
                -moz-transition: all 0.5s;
                transition: all 0.5s;
            }

            .all-community-btn:hover {
                text-decoration: none;!important;
                background-color: #ffffff;
                color: #7671F0;
                font-weight: bold;
                -webkit-transition: all 0.5s;
                -moz-transition: all 0.5s;
                transition: all 0.5s;
            }

            #mainpage-community {
                text-align: center;
                padding: 2rem 0;
            }

            #community {
                font-size: 1.2rem;
                font-weight: bold;
                margin-bottom: .5rem;
            }

            #search-2 {
                width: 80%;
                border: none;
                border-bottom: 2px solid #662DE0;
            }

            #search-btn {
                background: transparent;
                color: #662DE0;
                border: none;
                font-size: 1.5rem;
            }

            .schools {
                display: flex;
                flex-direction: column;
            }

            .school-community-btn {
                text-decoration: none;!important;
                width: 50%;
                margin: auto;
                padding: 0.2rem 1.5rem;
                color: #000000;
                border-radius: 10rem;
                background-color: lightgrey;
                font-size: 1rem;
                border: 2px solid #ffffff;
                -webkit-transition: all 0.5s;
                -moz-transition: all 0.5s;
                transition: all 0.5s;
            }

            .school-community-btn:hover {
                text-decoration: none;!important;
                font-weight: bold;
                color: #000000;
                background-color: #ffffff;
                border: 2px solid lightgrey;
            }

            #main-service-4 {
                margin: 0;
                padding: 2rem;
                width: 100%;
                background-color: #61C4D9;
                text-align: center;
            }

            #sub-4 {
                margin-bottom: .3rem;
            }

            .create-review-btn {
                text-decoration: none;!important;
                padding: 0.2rem 2rem;
                margin: 1rem auto;
                border-radius: 10rem;
                font-size: 1.2rem;
                color: #000000;
                border: 2px solid #000000;
                -webkit-transition: all 0.5s;
                -moz-transition: all 0.5s;
                transition: all 0.5s;
            }

            .create-review-btn:hover {
                text-decoration: none;!important;
                background-color: #000000;
                color: #ffffff;
                font-weight: bold;
                -webkit-transition: all 0.5s;
                -moz-transition: all 0.5s;
                transition: all 0.5s;
            }
            #main-footer {
                text-align: center;
            }

            @media screen and (max-width: 480px) {
                .container {
                    width: 100%;
                }
            }

            @font-face {
                font-family: 'MapoDPPA';
                src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2001@1.1/MapoDPPA.woff') format('woff');
                font-weight: normal;
                font-style: normal;
            }

        </style>


        <script type="text/javascript">
            function isElementUnderBottom(elem, triggerDiff) {
                const {top} = elem.getBoundingClientRect();
                const {innerHeight} = window;
                return top > innerHeight + (triggerDiff || 0);
            }

            function handleScroll() {
                const elems = document.querySelectorAll('.up-on-scroll');
                elems.forEach(elem => {
                    if (isElementUnderBottom(elem, -20)) {
                        elem.style.opacity = "0";
                        elem.style.transform = 'translateY(70px)';

                    } else {
                        elem.style.opacity = "1";
                        elem.style.transform = 'translateY(0px)';

                    }
                })
            }

            window.addEventListener('scroll', handleScroll);
        </script>
    </head>

<body>
<div class="mainpage-login">
    {% if user.is_authenticated %}
        <a href="{% url "user:logout" %}" class="mainpage-btn">Logout</a>
        <a href="{% url "community:my_page" %}" class="mainpage-btn">My Page</a>
    {% else %}
        <a href="{% url "user:login" %}" class="mainpage-btn">Login</a>
        <a href="{% url "user:signup" %}" class="mainpage-btn">Sign up</a>
    {% endif %}
</div>
<div class="mainpage-logo">
    <div id="dandi"><i class="fas fa-home"></i> 단디알아방</div>
    <div id="comment">자취방/하숙집 사용후기 공유 커뮤니티 서비스</div>
</div>
<div class="container">
    <div class="row" id="main-service-1">
        <div class="col-lg-6" id="title-1">
            <div id="sub-title-1" class="up-on-scroll">효율적인 자취방 거래를 위한</br>거주후기 공유 서비스</div>
            <p class="up-on-scroll">자취방을 구할 때 곰팡이, 벌레, 소음 등 직접 살아봐야만</br>알 수 있는 정보들을 알 수 없어 답답했던 경험이 있나요?</p>
            <p class="up-on-scroll">그 집에 살았던 사람들의 생생한 거주후기를 통해 </br>현명하게 자취방을 구해보세요.</p>
            <p class="up-on-scroll">자취방 후기 지도를 통해 한눈에 </br>거주 후기들을 열람하고 공유할 수 있답니다.</p>
        </div>
        <div class="col-lg-6" id="main-service-map">
            <img src="static/mapmain.png">
            <a href="{% url 'review:map_main' %}" class="mainpage-map-btn">리뷰 지도 보러 가기</a>
        </div>
    </div>
    <div class="row" id="main-service-2">
        <div id="sub-title-2" class="up-on-scroll">지혜로운 1인 가구 생활을 위한</br>자취 정보 커뮤니티</div>
        <p class="up-on-scroll">자취를 하면서 예상치 못한 문제들에 직면한 적이 있나요?</p>
        <p class="up-on-scroll">소소한 자취 꿀팁부터 고급 주거 정보들까지</br>대학 중심 자취 정보 커뮤니티를 통해 유용한 정보들을 공유해보세요.</p>
        <p class="up-on-scroll">자취 새내기부터 프로 자취러들까지 다양한 게시판들에 모여</br>도움을 주고받을 수 있답니다.</p>
        <a href="{% url "community:all_community_list" %}" class="all-community-btn">전체 커뮤니티</a>
    </div>
    <div class="row" id="main-service-3">
        <div class="col-lg-6" id="title-1">
            <div id="sub-title-1" class="up-on-scroll">서울 45개 캠퍼스 맞춤<br/>자취정보 커뮤니티</div>
            <p class="up-on-scroll">서울 45개 캠퍼스에 대하여 학교 이메일 인증을 거친</br>사용자들에 대해 각 학교 커뮤니티 서비스만을 제공합니다.</p>
        </div>
        <div class="col-lg-6" id="mainpage-community">
            <div id="community">우리학교 자취 커뮤니티 검색</div>
            <div class="search-box-2">
                <div class="container-2">
                    {% include 'school_search.html' %}
                </div>
                <br>
            </div>
            <div id="selectedschool"></div>
            {% if user.is_authenticated %}
                <div class="schools" id="schools">
                    <div id="alertmsg"></div>
                    {% for school in posts %}
                        <a href="/community/{{ school.id }}" class="school-community-btn">{{ school.name }}</a>
                    {% endfor %}
                    <div id="span">
                        {% if posts.has_previous %}
                            <a href="?page=1" id="page" style="text-decoration: none;color: #424242"><<</a>
                            <a href="?page={{ posts.previous_page_number }}" id="page"
                               style="text-decoration: none; color: #424242; padding-left: 5px;"> <</a>
                        {% endif %}

                        <span style="color: #424242;padding-left: 10px;">{{ posts.number }}</span>
                        <span style="color: #424242">/</span>
                        <span style="color: #424242; padding-right: 10px;">{{ posts.paginator.num_pages }}</span>
                        {% if posts.has_next %}
                            <a href="?page={{ posts.next_page_number }}" id="page"
                               style="text-decoration: none;color: #424242; padding-right: 5px;"> ></a>
                            <a href="?page={{ posts.paginator.num_pages }}" id="page"
                               style="text-decoration: none;color: #424242"> >></a>
                        {% endif %}
                    </div>
                    <div id="alertmsg2"></div>
                </div>
            {% else %}
                <div class="schools" id="schools">
                    <div id="alertmsg"></div>
                    {% for school in posts %}
                        <a onclick="notlogin()" class="school-community-btn">{{ school.name }}</a>
                    {% endfor %}
                    <div id="span">
                        {% if posts.has_previous %}
                            <a href="?page=1" id="page" style="text-decoration: none;color: #808080"><<</a>
                            <a href="?page={{ posts.previous_page_number }}" id="page"
                               style="text-decoration: none; color: #808080; padding-left: 5px;"> <</a>
                        {% endif %}

                        <span style="color: #808080;padding-left: 10px;">{{ posts.number }}</span>
                        <span style="color: #808080">/</span>
                        <span style="color: #808080; padding-right: 10px;">{{ posts.paginator.num_pages }}</span>
                        {% if posts.has_next %}
                            <a href="?page={{ posts.next_page_number }}" id="page"
                               style="text-decoration: none;color: #808080; padding-right: 5px;"> ></a>
                            <a href="?page={{ posts.paginator.num_pages }}" id="page"
                               style="text-decoration: none;color: #808080"> >></a>
                        {% endif %}
                    </div>
                    <div id="alertmsg2" style="padding-bottom: 10px; padding-top: 0;"></div>
                </div>
            {% endif %}
        </div>
    </div>
    <div class="row" id="main-service-4">
        <div class="col-lg-6" id="title-4-img">
            <img src="/static/home.png" width="300" height="300" style="margin-top: 0;">
        </div>
        <div class="col-lg-6" id="title-1">
            <div id="sub-title-1" class="up-on-scroll">단디알아방의 야심작 '땅문서 제도'</div>
            <div id="sub-title-1" class="up-on-scroll">내 거주 후기를 작성하고</br>타인의 거주 후기를 공유하세요!</div>
            <p class="up-on-scroll" id="sub-4">회원가입 시 +10땅문서</p>
            <p class="up-on-scroll" id="sub-4">커뮤니티에 글 작성 시 +1땅문서</p>
            <p class="up-on-scroll" id="sub-4">거주 후기 작성 시 +10땅문서</p>
            <p class="up-on-scroll" id="sub-4">거주 후기 열람 시 -3땅문서</p>
            <a class="create-review-btn" href="{% url 'review:createaddress' %}">리뷰 쓰러 가기</a>
        </div>
    </div>
</div>
<div class="row" id="main-footer" style="height: 50px; padding-top: 2rem;">
    <div class="col-lg-2">©단디 알아방</div>
    <div class="col-lg-4">피로그래밍 13기 | 팀프로젝트 1조</div>
    <div class="col-lg-6"> 팀원: 배인경 이예진 이유림 이지호 한지영</div>
</div>

</div>


<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
        integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>

</body>

<script>
    function search() {
        input = document.getElementById("search-2").value
        console.log(input)
        var list = []
        {% for school in schools %}
            list.push('{{school.name}}')
        {% endfor %}
        if (list.includes(input)) {
        } else {
            document.getElementById('alertmsg').innerHTML = '다시 입력해주세요!'
            document.getElementById('btn').style.display = 'block'
        }
        {% for school in schools %}
            if (input === '{{school.name}}') {
                school = document.getElementById('{{school.name}}')
                console.log(school)
                console.log(school)
                console.log(typeof (school))
                {% if user.is_authenticated %}
                    school = "<br/><a href='/community/{{ school.id }}' id='{{school.name}}' class='search-school-community-btn' >{{ school.name }}</a>"
                {% else %}
                    school = "<br/><a onclick='notlogin()' id='{{school.name}}' class='search-school-community-btn' >{{ school.name }}</a>"
                {% endif %}

                document.getElementById('selectedschool').innerHTML = school
                document.getElementById('alertmsg').innerHTML = ''
                document.getElementById('schools').style.display = 'none'

            }
        {% endfor %}
    }
</script>

<script>
    function notlogin() {
        var confirm_test = confirm("로그인 후 이용가능한 서비스입니다.로그인하시겠습니까?");

        if (confirm_test == true) {
            location = '{% url "user:login" %}';

        } else if (confirm_test == false) {
            alert("취소(아니오)를 누르셨습니다.");
        }
    }
</script>
</html>